!function(t){function e(r){if(n[r])return n[r].exports;var o=n[r]={i:r,l:!1,exports:{}};return t[r].call(o.exports,o,o.exports,e),o.l=!0,o.exports}var n={};e.m=t,e.c=n,e.d=function(t,n,r){e.o(t,n)||Object.defineProperty(t,n,{configurable:!1,enumerable:!0,get:r})},e.n=function(t){var n=t&&t.__esModule?function(){return t.default}:function(){return t};return e.d(n,"a",n),n},e.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},e.p="",e(e.s=2)}([function(t,e,n){"use strict";function r(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e.default=t,e}Object.defineProperty(e,"__esModule",{value:!0}),e.refreshView=e.getExpandedCellData=void 0;var o=n(10),i=r(o),s=n(13),a=r(s),u=new Date,c=(e.getExpandedCellData=function(t){return new Promise(function(e,n){i.getExpandedMSPMap(t).then(function(t){e(t)})})},e.refreshView=function(t,e){i.getMSPMap(t).then(function(n){a.refreshCells(n,t,e)})});a.init(u),c(u,"party")},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});e.strToDate=function(t){var e=t.indexOf("T");-1!=e&&(t=t.substring(0,e),t=t.replace(/\s+/g,""));var n=t.split("-"),r=n[0],o=n[1],i=n[2];return new Date(r,o-1,i)},e.dateToStr=function(t){var e=t.getFullYear(),n=""+(t.getMonth()+1);n=n.length<2?"0"+n:n;var r=""+t.getDate();return r=r.length<2?"0"+r:r,e+"-"+n+"-"+r},e.replaceNewlines=function(t){return t.replace(/(?:\\[rn])+/g,". ")}},function(t,e,n){n(3),n(4),n(9),t.exports=n(0)},function(t,e,n){"use strict";/*! @source http://purl.eligrey.com/github/classList.js/blob/master/classList.js */
"document"in window.self&&("classList"in document.createElement("_")&&(!document.createElementNS||"classList"in document.createElementNS("http://www.w3.org/2000/svg","g"))||function(t){if("Element"in t){var e=t.Element.prototype,n=Object,r=String.prototype.trim||function(){return this.replace(/^\s+|\s+$/g,"")},o=Array.prototype.indexOf||function(t){for(var e=0,n=this.length;e<n;e++)if(e in this&&this[e]===t)return e;return-1},i=function(t,e){this.name=t,this.code=DOMException[t],this.message=e},s=function(t,e){if(""===e)throw new i("SYNTAX_ERR","An invalid or illegal string was specified");if(/\s/.test(e))throw new i("INVALID_CHARACTER_ERR","String contains an invalid character");return o.call(t,e)},a=function(t){for(var e=r.call(t.getAttribute("class")||""),n=e?e.split(/\s+/):[],o=0,i=n.length;o<i;o++)this.push(n[o]);this._updateClassName=function(){t.setAttribute("class",this.toString())}},u=a.prototype=[],c=function(){return new a(this)};if(i.prototype=Error.prototype,u.item=function(t){return this[t]||null},u.contains=function(t){return t+="",-1!==s(this,t)},u.add=function(){var t,e=arguments,n=0,r=e.length,o=!1;do{t=e[n]+"",-1===s(this,t)&&(this.push(t),o=!0)}while(++n<r);o&&this._updateClassName()},u.remove=function(){var t,e,n=arguments,r=0,o=n.length,i=!1;do{for(t=n[r]+"",e=s(this,t);-1!==e;)this.splice(e,1),i=!0,e=s(this,t)}while(++r<o);i&&this._updateClassName()},u.toggle=function(t,e){t+="";var n=this.contains(t),r=n?!0!==e&&"remove":!1!==e&&"add";return r&&this[r](t),!0===e||!1===e?e:!n},u.toString=function(){return this.join(" ")},n.defineProperty){var l={get:c,enumerable:!0,configurable:!0};try{n.defineProperty(e,"classList",l)}catch(t){void 0!==t.number&&-2146823252!==t.number||(l.enumerable=!1,n.defineProperty(e,"classList",l))}}else n.prototype.__defineGetter__&&e.__defineGetter__("classList",c)}}(window.self),function(){var t=document.createElement("_");if(t.classList.add("c1","c2"),!t.classList.contains("c2")){var e=function(t){var e=DOMTokenList.prototype[t];DOMTokenList.prototype[t]=function(t){var n,r=arguments.length;for(n=0;n<r;n++)t=arguments[n],e.call(this,t)}};e("add"),e("remove")}if(t.classList.toggle("c3",!1),t.classList.contains("c3")){var n=DOMTokenList.prototype.toggle;DOMTokenList.prototype.toggle=function(t,e){return 1 in arguments&&!this.contains(t)==!e?e:n.call(this,t)}}t=null}())},function(t,e,n){"use strict";(function(e){var n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t};!function(r){function o(){}function i(t,e){return function(){t.apply(e,arguments)}}function s(t){if("object"!==n(this))throw new TypeError("Promises must be constructed via new");if("function"!=typeof t)throw new TypeError("not a function");this._state=0,this._handled=!1,this._value=void 0,this._deferreds=[],d(t,this)}function a(t,e){for(;3===t._state;)t=t._value;if(0===t._state)return void t._deferreds.push(e);t._handled=!0,s._immediateFn(function(){var n=1===t._state?e.onFulfilled:e.onRejected;if(null===n)return void(1===t._state?u:c)(e.promise,t._value);var r;try{r=n(t._value)}catch(t){return void c(e.promise,t)}u(e.promise,r)})}function u(t,e){try{if(e===t)throw new TypeError("A promise cannot be resolved with itself.");if(e&&("object"===(void 0===e?"undefined":n(e))||"function"==typeof e)){var r=e.then;if(e instanceof s)return t._state=3,t._value=e,void l(t);if("function"==typeof r)return void d(i(r,e),t)}t._state=1,t._value=e,l(t)}catch(e){c(t,e)}}function c(t,e){t._state=2,t._value=e,l(t)}function l(t){2===t._state&&0===t._deferreds.length&&s._immediateFn(function(){t._handled||s._unhandledRejectionFn(t._value)});for(var e=0,n=t._deferreds.length;e<n;e++)a(t,t._deferreds[e]);t._deferreds=null}function f(t,e,n){this.onFulfilled="function"==typeof t?t:null,this.onRejected="function"==typeof e?e:null,this.promise=n}function d(t,e){var n=!1;try{t(function(t){n||(n=!0,u(e,t))},function(t){n||(n=!0,c(e,t))})}catch(t){if(n)return;n=!0,c(e,t)}}var p=setTimeout;s.prototype.catch=function(t){return this.then(null,t)},s.prototype.then=function(t,e){var n=new this.constructor(o);return a(this,new f(t,e,n)),n},s.all=function(t){var e=Array.prototype.slice.call(t);return new s(function(t,r){function o(s,a){try{if(a&&("object"===(void 0===a?"undefined":n(a))||"function"==typeof a)){var u=a.then;if("function"==typeof u)return void u.call(a,function(t){o(s,t)},r)}e[s]=a,0==--i&&t(e)}catch(t){r(t)}}if(0===e.length)return t([]);for(var i=e.length,s=0;s<e.length;s++)o(s,e[s])})},s.resolve=function(t){return t&&"object"===(void 0===t?"undefined":n(t))&&t.constructor===s?t:new s(function(e){e(t)})},s.reject=function(t){return new s(function(e,n){n(t)})},s.race=function(t){return new s(function(e,n){for(var r=0,o=t.length;r<o;r++)t[r].then(e,n)})},s._immediateFn="function"==typeof e&&function(t){e(t)}||function(t){p(t,0)},s._unhandledRejectionFn=function(t){"undefined"!=typeof console&&console&&console.warn("Possible Unhandled Promise Rejection:",t)},s._setImmediateFn=function(t){s._immediateFn=t},s._setUnhandledRejectionFn=function(t){s._unhandledRejectionFn=t},void 0!==t&&t.exports?t.exports=s:r.Promise||(r.Promise=s)}(void 0)}).call(e,n(5).setImmediate)},function(t,e,n){"use strict";function r(t,e){this._id=t,this._clearFn=e}var o=Function.prototype.apply;e.setTimeout=function(){return new r(o.call(setTimeout,window,arguments),clearTimeout)},e.setInterval=function(){return new r(o.call(setInterval,window,arguments),clearInterval)},e.clearTimeout=e.clearInterval=function(t){t&&t.close()},r.prototype.unref=r.prototype.ref=function(){},r.prototype.close=function(){this._clearFn.call(window,this._id)},e.enroll=function(t,e){clearTimeout(t._idleTimeoutId),t._idleTimeout=e},e.unenroll=function(t){clearTimeout(t._idleTimeoutId),t._idleTimeout=-1},e._unrefActive=e.active=function(t){clearTimeout(t._idleTimeoutId);var e=t._idleTimeout;e>=0&&(t._idleTimeoutId=setTimeout(function(){t._onTimeout&&t._onTimeout()},e))},n(6),e.setImmediate=setImmediate,e.clearImmediate=clearImmediate},function(t,e,n){"use strict";(function(t,e){!function(t,n){function r(t){"function"!=typeof t&&(t=new Function(""+t));for(var e=new Array(arguments.length-1),n=0;n<e.length;n++)e[n]=arguments[n+1];var r={callback:t,args:e};return c[u]=r,a(u),u++}function o(t){delete c[t]}function i(t){var e=t.callback,r=t.args;switch(r.length){case 0:e();break;case 1:e(r[0]);break;case 2:e(r[0],r[1]);break;case 3:e(r[0],r[1],r[2]);break;default:e.apply(n,r)}}function s(t){if(l)setTimeout(s,0,t);else{var e=c[t];if(e){l=!0;try{i(e)}finally{o(t),l=!1}}}}if(!t.setImmediate){var a,u=1,c={},l=!1,f=t.document,d=Object.getPrototypeOf&&Object.getPrototypeOf(t);d=d&&d.setTimeout?d:t,"[object process]"==={}.toString.call(t.process)?function(){a=function(t){e.nextTick(function(){s(t)})}}():function(){if(t.postMessage&&!t.importScripts){var e=!0,n=t.onmessage;return t.onmessage=function(){e=!1},t.postMessage("","*"),t.onmessage=n,e}}()?function(){var e="setImmediate$"+Math.random()+"$",n=function(n){n.source===t&&"string"==typeof n.data&&0===n.data.indexOf(e)&&s(+n.data.slice(e.length))};t.addEventListener?t.addEventListener("message",n,!1):t.attachEvent("onmessage",n),a=function(n){t.postMessage(e+n,"*")}}():t.MessageChannel?function(){var t=new MessageChannel;t.port1.onmessage=function(t){s(t.data)},a=function(e){t.port2.postMessage(e)}}():f&&"onreadystatechange"in f.createElement("script")?function(){var t=f.documentElement;a=function(e){var n=f.createElement("script");n.onreadystatechange=function(){s(e),n.onreadystatechange=null,t.removeChild(n),n=null},t.appendChild(n)}}():function(){a=function(t){setTimeout(s,0,t)}}(),d.setImmediate=r,d.clearImmediate=o}}("undefined"==typeof self?void 0===t?void 0:t:self)}).call(e,n(7),n(8))},function(t,e,n){"use strict";var r,o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t};r=function(){return this}();try{r=r||Function("return this")()||(0,eval)("this")}catch(t){"object"===("undefined"==typeof window?"undefined":o(window))&&(r=window)}t.exports=r},function(t,e,n){"use strict";function r(){throw new Error("setTimeout has not been defined")}function o(){throw new Error("clearTimeout has not been defined")}function i(t){if(f===setTimeout)return setTimeout(t,0);if((f===r||!f)&&setTimeout)return f=setTimeout,setTimeout(t,0);try{return f(t,0)}catch(e){try{return f.call(null,t,0)}catch(e){return f.call(this,t,0)}}}function s(t){if(d===clearTimeout)return clearTimeout(t);if((d===o||!d)&&clearTimeout)return d=clearTimeout,clearTimeout(t);try{return d(t)}catch(e){try{return d.call(null,t)}catch(e){return d.call(this,t)}}}function a(){y&&m&&(y=!1,m.length?h=m.concat(h):v=-1,h.length&&u())}function u(){if(!y){var t=i(a);y=!0;for(var e=h.length;e;){for(m=h,h=[];++v<e;)m&&m[v].run();v=-1,e=h.length}m=null,y=!1,s(t)}}function c(t,e){this.fun=t,this.array=e}function l(){}var f,d,p=t.exports={};!function(){try{f="function"==typeof setTimeout?setTimeout:r}catch(t){f=r}try{d="function"==typeof clearTimeout?clearTimeout:o}catch(t){d=o}}();var m,h=[],y=!1,v=-1;p.nextTick=function(t){var e=new Array(arguments.length-1);if(arguments.length>1)for(var n=1;n<arguments.length;n++)e[n-1]=arguments[n];h.push(new c(t,e)),1!==h.length||y||i(u)},c.prototype.run=function(){this.fun.apply(null,this.array)},p.title="browser",p.browser=!0,p.env={},p.argv=[],p.version="",p.versions={},p.on=l,p.addListener=l,p.once=l,p.off=l,p.removeListener=l,p.removeAllListeners=l,p.emit=l,p.prependListener=l,p.prependOnceListener=l,p.listeners=function(t){return[]},p.binding=function(t){throw new Error("process.binding is not supported")},p.cwd=function(){return"/"},p.chdir=function(t){throw new Error("process.chdir is not supported")},p.umask=function(){return 0}},function(t,e,n){"use strict";!function(t){function e(t){if("string"!=typeof t&&(t=String(t)),/[^a-z0-9\-#$%&'*+.\^_`|~]/i.test(t))throw new TypeError("Invalid character in header field name");return t.toLowerCase()}function n(t){return"string"!=typeof t&&(t=String(t)),t}function r(t){var e={next:function(){var e=t.shift();return{done:void 0===e,value:e}}};return v.iterable&&(e[Symbol.iterator]=function(){return e}),e}function o(t){this.map={},t instanceof o?t.forEach(function(t,e){this.append(e,t)},this):Array.isArray(t)?t.forEach(function(t){this.append(t[0],t[1])},this):t&&Object.getOwnPropertyNames(t).forEach(function(e){this.append(e,t[e])},this)}function i(t){if(t.bodyUsed)return Promise.reject(new TypeError("Already read"));t.bodyUsed=!0}function s(t){return new Promise(function(e,n){t.onload=function(){e(t.result)},t.onerror=function(){n(t.error)}})}function a(t){var e=new FileReader,n=s(e);return e.readAsArrayBuffer(t),n}function u(t){var e=new FileReader,n=s(e);return e.readAsText(t),n}function c(t){for(var e=new Uint8Array(t),n=new Array(e.length),r=0;r<e.length;r++)n[r]=String.fromCharCode(e[r]);return n.join("")}function l(t){if(t.slice)return t.slice(0);var e=new Uint8Array(t.byteLength);return e.set(new Uint8Array(t)),e.buffer}function f(){return this.bodyUsed=!1,this._initBody=function(t){if(this._bodyInit=t,t)if("string"==typeof t)this._bodyText=t;else if(v.blob&&Blob.prototype.isPrototypeOf(t))this._bodyBlob=t;else if(v.formData&&FormData.prototype.isPrototypeOf(t))this._bodyFormData=t;else if(v.searchParams&&URLSearchParams.prototype.isPrototypeOf(t))this._bodyText=t.toString();else if(v.arrayBuffer&&v.blob&&g(t))this._bodyArrayBuffer=l(t.buffer),this._bodyInit=new Blob([this._bodyArrayBuffer]);else{if(!v.arrayBuffer||!ArrayBuffer.prototype.isPrototypeOf(t)&&!w(t))throw new Error("unsupported BodyInit type");this._bodyArrayBuffer=l(t)}else this._bodyText="";this.headers.get("content-type")||("string"==typeof t?this.headers.set("content-type","text/plain;charset=UTF-8"):this._bodyBlob&&this._bodyBlob.type?this.headers.set("content-type",this._bodyBlob.type):v.searchParams&&URLSearchParams.prototype.isPrototypeOf(t)&&this.headers.set("content-type","application/x-www-form-urlencoded;charset=UTF-8"))},v.blob&&(this.blob=function(){var t=i(this);if(t)return t;if(this._bodyBlob)return Promise.resolve(this._bodyBlob);if(this._bodyArrayBuffer)return Promise.resolve(new Blob([this._bodyArrayBuffer]));if(this._bodyFormData)throw new Error("could not read FormData body as blob");return Promise.resolve(new Blob([this._bodyText]))},this.arrayBuffer=function(){return this._bodyArrayBuffer?i(this)||Promise.resolve(this._bodyArrayBuffer):this.blob().then(a)}),this.text=function(){var t=i(this);if(t)return t;if(this._bodyBlob)return u(this._bodyBlob);if(this._bodyArrayBuffer)return Promise.resolve(c(this._bodyArrayBuffer));if(this._bodyFormData)throw new Error("could not read FormData body as text");return Promise.resolve(this._bodyText)},v.formData&&(this.formData=function(){return this.text().then(m)}),this.json=function(){return this.text().then(JSON.parse)},this}function d(t){var e=t.toUpperCase();return _.indexOf(e)>-1?e:t}function p(t,e){e=e||{};var n=e.body;if(t instanceof p){if(t.bodyUsed)throw new TypeError("Already read");this.url=t.url,this.credentials=t.credentials,e.headers||(this.headers=new o(t.headers)),this.method=t.method,this.mode=t.mode,n||null==t._bodyInit||(n=t._bodyInit,t.bodyUsed=!0)}else this.url=String(t);if(this.credentials=e.credentials||this.credentials||"omit",!e.headers&&this.headers||(this.headers=new o(e.headers)),this.method=d(e.method||this.method||"GET"),this.mode=e.mode||this.mode||null,this.referrer=null,("GET"===this.method||"HEAD"===this.method)&&n)throw new TypeError("Body not allowed for GET or HEAD requests");this._initBody(n)}function m(t){var e=new FormData;return t.trim().split("&").forEach(function(t){if(t){var n=t.split("="),r=n.shift().replace(/\+/g," "),o=n.join("=").replace(/\+/g," ");e.append(decodeURIComponent(r),decodeURIComponent(o))}}),e}function h(t){var e=new o;return t.split(/\r?\n/).forEach(function(t){var n=t.split(":"),r=n.shift().trim();if(r){var o=n.join(":").trim();e.append(r,o)}}),e}function y(t,e){e||(e={}),this.type="default",this.status="status"in e?e.status:200,this.ok=this.status>=200&&this.status<300,this.statusText="statusText"in e?e.statusText:"OK",this.headers=new o(e.headers),this.url=e.url||"",this._initBody(t)}if(!t.fetch){var v={searchParams:"URLSearchParams"in t,iterable:"Symbol"in t&&"iterator"in Symbol,blob:"FileReader"in t&&"Blob"in t&&function(){try{return new Blob,!0}catch(t){return!1}}(),formData:"FormData"in t,arrayBuffer:"ArrayBuffer"in t};if(v.arrayBuffer)var b=["[object Int8Array]","[object Uint8Array]","[object Uint8ClampedArray]","[object Int16Array]","[object Uint16Array]","[object Int32Array]","[object Uint32Array]","[object Float32Array]","[object Float64Array]"],g=function(t){return t&&DataView.prototype.isPrototypeOf(t)},w=ArrayBuffer.isView||function(t){return t&&b.indexOf(Object.prototype.toString.call(t))>-1};o.prototype.append=function(t,r){t=e(t),r=n(r);var o=this.map[t];this.map[t]=o?o+","+r:r},o.prototype.delete=function(t){delete this.map[e(t)]},o.prototype.get=function(t){return t=e(t),this.has(t)?this.map[t]:null},o.prototype.has=function(t){return this.map.hasOwnProperty(e(t))},o.prototype.set=function(t,r){this.map[e(t)]=n(r)},o.prototype.forEach=function(t,e){for(var n in this.map)this.map.hasOwnProperty(n)&&t.call(e,this.map[n],n,this)},o.prototype.keys=function(){var t=[];return this.forEach(function(e,n){t.push(n)}),r(t)},o.prototype.values=function(){var t=[];return this.forEach(function(e){t.push(e)}),r(t)},o.prototype.entries=function(){var t=[];return this.forEach(function(e,n){t.push([n,e])}),r(t)},v.iterable&&(o.prototype[Symbol.iterator]=o.prototype.entries);var _=["DELETE","GET","HEAD","OPTIONS","POST","PUT"];p.prototype.clone=function(){return new p(this,{body:this._bodyInit})},f.call(p.prototype),f.call(y.prototype),y.prototype.clone=function(){return new y(this._bodyInit,{status:this.status,statusText:this.statusText,headers:new o(this.headers),url:this.url})},y.error=function(){var t=new y(null,{status:0,statusText:""});return t.type="error",t};var T=[301,302,303,307,308];y.redirect=function(t,e){if(-1===T.indexOf(e))throw new RangeError("Invalid status code");return new y(null,{status:e,headers:{location:t}})},t.Headers=o,t.Request=p,t.Response=y,t.fetch=function(t,e){return new Promise(function(n,r){var o=new p(t,e),i=new XMLHttpRequest;i.onload=function(){var t={status:i.status,statusText:i.statusText,headers:h(i.getAllResponseHeaders()||"")};t.url="responseURL"in i?i.responseURL:t.headers.get("X-Request-URL");var e="response"in i?i.response:i.responseText;n(new y(e,t))},i.onerror=function(){r(new TypeError("Network request failed"))},i.ontimeout=function(){r(new TypeError("Network request failed"))},i.open(o.method,o.url,!0),"include"===o.credentials&&(i.withCredentials=!0),"responseType"in i&&v.blob&&(i.responseType="blob"),o.headers.forEach(function(t,e){i.setRequestHeader(e,t)}),i.send(void 0===o._bodyInit?null:o._bodyInit)})},t.fetch.polyfill=!0}}("undefined"!=typeof self?self:void 0)},function(t,e,n){"use strict";function r(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e.default=t,e}Object.defineProperty(e,"__esModule",{value:!0}),e.getExpandedMSPMap=e.getMSPMap=void 0;var o=n(1),i=r(o),s=n(11),a=r(s),u=n(12),c=r(u),l=null,f=null,d=null,p=function(t,e){var n=i.strToDate(e.ValidFromDate),r=null!=e.ValidUntilDate?i.strToDate(e.ValidUntilDate):null;return t>=n&&t<=r||t>=n&&null==r},m=function(t,e,n){return n?function(r){return r[t]===e&&p(n,r)}:function(n){return n[t]===e}},h=function(t){return t.includes("Parliamentary Liaison Officer")?9:t.includes("Deputy First Minister")?1:t.includes("First Minister")?0:t.includes("Minister")?3:t.includes("Cabinet Secretary")?2:t.includes("Deputy Party Spokesperson on")||t.includes("Deputy Whip")?8:t.includes("Party Spokesperson on")||t.includes("Chief Whip")?7:t.includes("Deputy Party Leader")?6:t.includes("Party Leader")?5:"Substitute Member"===t?13:"Member"===t?12:"Deputy Convener"===t?11:"Co-Convener"===t?10:"Convener"===t?9:15},y=function(t,e,n,r,o,s,u,c){n.forEach(function(n){var l=e.get(n.PersonID);if(l&&p(t,n)){var f=r.find(m("ID",n[o])),d=i.replaceNewlines(f.Name),y=h(f.Name);if(s&&u){var v=s.find(m("ID",n[u]));l[c].push(new a.Role(d,y,v.Name))}else{l[c].find(function(t){return t.name===d})||l[c].push(new a.Role(d,y,"SG"))}}})},v=function(t,e,n,r,o,i){e.forEach(function(e){var s=t.get(e.PersonID);if(s){var u=r.find(m("ID",e[o])).Name;if("Line1"===n){var c=e.Line1+", "+e.Line2,l=new a.Address(u,c,e.PostCode,e.Region,e.Town);s[i].push(l)}else if(e[n]){var f=new a.Contact(u,e[n]);s[i].push(f)}}})},b=function(t){t.forEach(function(t){for(var e in t)Array.isArray(t[e])&&"govtRoles"!=e&&"partyRoles"!=e&&(t[e]=[])})},g=function(t,e){var n=new Map;return e.regResults.concat(e.constitResults).forEach(function(r){if(p(t,r)){var o=new a.MSP;if(r.ConstituencyID){var i=e.constituencies.find(m("ID",r.ConstituencyID));o.constit=new a.Area(i.Name,i.ConstituencyCode);var s=e.regions.find(m("ID",i.RegionID));o.region=new a.Area(s.Name,s.RegionCode)}else{var u=e.regions.find(m("ID",r.RegionID));o.region=new a.Area(u.Name,u.RegionCode)}n.set(r.PersonID,o)}}),e.basicMSPData.forEach(function(t){var e=n.get(t.PersonID);if(e){var r=t.ParliamentaryName.split(",");e.firstName=r[1],e.lastName=r[0],t.BirthDateIsProtected||(e.DOB=i.strToDate(t.BirthDate)),e.photoURL=t.PhotoURL}}),e.partyMemberships.forEach(function(r){var o=n.get(r.PersonID);if(o&&p(t,r)){var s=e.parties.find(m("ID",r.PartyID));s.Abbreviation="*"===s.Abbreviation?"Ind":s.Abbreviation,o.party=new a.Party(s.ActualName,s.Abbreviation);var u=e.partyMemberRoles.filter(m("MemberPartyID",r.ID,t));u&&u.forEach(function(n){var s=e.partyRoles.find(m("ID",n.PartyRoleTypeID)),u=s.Name,c=i.replaceNewlines(n.Notes);if(3812===r.PersonID&&t>new Date(2017,7,29)&&"Party Leader"===u)return 0;var l=h(u);o.partyRoles.push(new a.Role(u,l,c))}),"NPA"===o.party.abbreviation&&o.partyRoles.push(new a.Role("Presiding Officer",0,"Presiding Officer"))}}),y(t,n,e.govtMemberRoles,e.govtRoles,"GovernmentRoleID","","","govtRoles"),n},w=function(t,e){b(d),y(t,d,e.membercpgRoles,e.cpgRoles,"CrossPartyGroupRoleID",e.cpgs,"CrossPartyGroupID","cpgRoles"),y(t,d,e.memberCommitteeRoles,e.committeeRoles,"CommitteeRoleID",e.committees,"CommitteeID","committeeRoles"),v(d,e.addresses,"Line1",e.addressTypes,"AddressTypeID","addresses"),v(d,e.emails,"Address",e.emailTypes,"EmailAddressTypeID","emails"),v(d,e.telephones,"Telephone1",e.telephoneTypes,"TelephoneTypeID","telephones"),v(d,e.websites,"WebURL",e.websiteTypes,"WebSiteTypeID","websites")};e.getMSPMap=function(t){return new Promise(function(e,n){l?(d=g(t,l),e(d)):c.getInitialMSPData().then(function(n){l=n,d=g(t,l),e(d)})})},e.getExpandedMSPMap=function(t){return new Promise(function(e,n){f?(w(t,f),e(d)):c.getExpandedMSPData().then(function(n){f=n,w(t,f),e(d)})})}},function(t,e,n){"use strict";function r(t,e){this.name=t,this.code=e}function o(t,e){this.name=t,this.abbreviation=e}function i(t,e,n){this.name=t,this.rank=e,this.altText=n}function s(t,e,n,r,o){this.type=t,this.street=e,this.postCode=n,this.region=r,this.town=o}function a(t,e){this.type=t,this.value=e}function u(t,e,n,r,o,i,s,a){this.constit=e,this.region=n,this.firstName=r,this.lastName=o,this.DOB=i,this.photoURL=s,this.party=a,this.partyRoles=[],this.govtRoles=[],this.committeeRoles=[],this.cpgRoles=[],this.addresses=[],this.emails=[],this.telephones=[],this.websites=[]}Object.defineProperty(e,"__esModule",{value:!0}),e.Area=r,e.Party=o,e.Role=i,e.Address=s,e.Contact=a,e.MSP=u},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r="https://data.parliament.scot/api/",o=function(t){return new Promise(function(e,n){fetch(t,{method:"get"}).then(function(t){return t.json()}).then(function(t){e(t)})})};e.getInitialMSPData=function(){return new Promise(function(t,e){Promise.all([o(r+"members"),o(r+"MemberElectionConstituencyStatuses"),o(r+"MemberElectionregionStatuses"),o(r+"constituencies"),o(r+"regions"),o(r+"parties"),o(r+"memberparties"),o(r+"partyroles"),o(r+"memberpartyroles"),o(r+"governmentroles"),o(r+"membergovernmentroles")]).then(function(e){var n={basicMSPData:e[0],constitResults:e[1],regResults:e[2],constituencies:e[3],regions:e[4],parties:e[5],partyMemberships:e[6],partyRoles:e[7],partyMemberRoles:e[8],govtRoles:e[9],govtMemberRoles:e[10]};t(n)})})},e.getExpandedMSPData=function(){return new Promise(function(t,e){Promise.all([o(r+"addresses"),o(r+"addresstypes"),o(r+"telephones"),o(r+"telephonetypes"),o(r+"emailaddresses"),o(r+"emailaddresstypes"),o(r+"websites"),o(r+"websitetypes"),o(r+"membercrosspartyroles"),o(r+"crosspartygrouproles"),o(r+"crosspartygroups"),o(r+"personcommitteeroles"),o(r+"committeeroles"),o(r+"committees"),o(r+"committeetypelinks"),o(r+"committeetypes")]).then(function(e){var n={addresses:e[0],addressTypes:e[1],telephones:e[2],telephoneTypes:e[3],emails:e[4],emailTypes:e[5],websites:e[6],websiteTypes:e[7],membercpgRoles:e[8],cpgRoles:e[9],cpgs:e[10],memberCommitteeRoles:e[11],committeeRoles:e[12],committees:e[13],committeeTypeLinks:e[14],committeeTypes:e[15]};t(n)})})}},function(t,e,n){"use strict";function r(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e.default=t,e}Object.defineProperty(e,"__esModule",{value:!0}),e.refreshCells=e.init=void 0;var o=n(1),i=r(o),s=n(0),a=r(s),u=document.getElementsByTagName("main")[0],c=function(t){return document.createRange().createContextualFragment(t)},l=function(t){if(t.DOB){var e=t.DOB;return"<p>"+(e.getDate()+"/"+(e.getMonth()+1)+"/"+e.getFullYear())+"</p>"}return""},f=function(t,e){if(t.partyRoles&&t.partyRoles.length>0){var n=t.partyRoles.map(function(e){var n=e.name.trim();return"Party Leader"!==n||"Green"!==t.party.abbreviation&&"SSP"!==t.party.abbreviation&&"Sol"!==t.party.abbreviation||(n="Co-Convener"),n}).join(", ");return'<p class="msp-role">'+(n=n.replace(/Party Spokesperson on /g,""))+"</p>"}return""},d=function(t){if(t.govtRoles&&t.govtRoles.length>0){return'<p class="msp-role">'+t.govtRoles.map(function(t){return t.name.trim()}).join(", ")+"</p>"}return""},p=function(t){return!(!t||-1!=t.search("Parliamentary Liaison Officer"))},m=function(t){var e="";return e=t.constit?t.constit.name:t.region.name,e=e.replace(/ and /g," & ")},h=function(t,e){return t.sort(function(t,n){var r=t[e],o=n[e];return r<o?-1:r>o?1:r===o?0:void 0})},y=function(t,e,n){return t.sort(function(t,r){var o=t[e][n],i=r[e][n];return o<i?-1:o>i?1:o===i?0:void 0})},v=function(t,e){var n=l(t),r=f(t),o=d(t),i="";t.emails&&t.emails.length>0&&(i=t.emails.map(function(t){return'<li> <a href="mailto:'+t.value+'">'+t.type+"</a></li>"}).join(""));var s="";t.websites&&t.websites.length>0&&(s=t.websites.map(function(t){return'<li> <a href="'+t.value+'">'+t.type+"</a></li>"}).join(""));var a="";t.addresses&&t.addresses.length>0&&(a=t.addresses.map(function(t){return"<p>\n\t\t\t\t\t<strong> "+t.type+" Address: </strong>\n\t\t\t\t\t"+t.street+"\n\t\t\t\t\t"+t.postCode+"\n\t\t\t\t\t"+(t.region?t.region:"")+"\n\t\t\t\t\t"+t.town+"\n\n\t\t\t</p>"}).join(""));var u=h(t.committeeRoles,"rank").map(function(t){return"<li>\n\t\t"+("Member"===t.name?"":t.name+" &ndash;").replace(/Substitute Member/g,"Substitute")+"\n\t\t"+t.altText+"\n\t</li>"}).join(""),c=h(t.cpgRoles,"rank").map(function(t){return"<li>\n\t\t"+("Member"===t.name?"":t.name+" &ndash;")+"\n\t\t"+t.altText.replace(/Cross-Party Group in the Scottish Parliament on/g,"")+"\n\t</li>"}).join("");return'\n\t<div class="modal--box-pbox">\n\t\n\t\t<img class="modal--box-img" src="http://via.placeholder.com/250x250"></img>\n\t\t\n\t\t<h3 class="msp-name">'+t.firstName+" "+t.lastName+"</h3>\n\t\t"+(n||"")+"\n\t\t<p>"+t.party.name+"</p>\n\t\t<p>"+(t.constit?t.constit.name+", ":"")+t.region.name+"</p>\n\t\t"+(r||"")+"\n\t\t"+(o||"")+'\n\n\t</div>\n\t\n\t<div class="modal--box-txtbox">\n\t\n\t\t<h4>Contact</h4>\n\n\t\t'+(a||"")+"\n\n\t\t"+(i||"")+"\n\n\t\t"+(s||"")+"\n\n\t\t"+(u&&u.length>0?"\n\t\t<h4>Committees</h4>\n\t\t<ul>"+u+"</ul>\n\t\t":"")+"\n\t\t\n\t\t"+(c&&c.length>0?"\n\t\t<h4>Cross-Party Groups</h4>\n\t\t<ul>"+c+"</ul>\n\t\t":"")+"\n\t\t\n\t</div>\n\t"},b=function(t,e){return function(){var n=document.getElementsByClassName("modal")[0];if(n.classList.contains("modal__hidden")){var r=document.getElementsByClassName("modal--box")[0],o=document.getElementsByClassName("modal--box-content")[0];n.classList.toggle("modal__hidden"),a.getExpandedCellData(e).then(function(e){var n=e.get(t);o.innerHTML=v(n),r.appendChild(o)})}}},g=function(t,e){var n=m(t),r=t.photoURL,o=t.firstName+" portrait";if(r){var i=r.substring(r.lastIndexOf("/")+1);i=i.replace(/\s+/g,""),r="/img/portraits/"+i+".jpg"}else r="#";var s=d(t),a=p(s),u=f(t);return'\n\t\t<div id="'+e+'" class="cell cell__pty-'+t.party.abbreviation+" "+(a?"cell__mini":"")+'">\n\t\t\t<div class="portrait-box">\n\t\t\t\t<img class="portrait-img" src="http://via.placeholder.com/75x75" alt="'+o+'">\n\t\t\t</div>\n\t\t\t<div class="txtbox">\n\t\t\t\t<h4 class="msp-name">'+t.firstName+" "+t.lastName+'</h4>\n\t\t\t\t<p>\n\t\t\t\t<span class="msp-party">('+t.party.abbreviation+')</span>\n\t\t\t\t<span class="msp-location">('+n+")</span>\n\t\t\t\t</p>\n\t\t\t\t"+(s||"")+"\n\t\t\t\t"+(u||"")+"\n\t\t\t</div>\n\t\t</div>\n\t\t"},w=function(t){var e=[];return t.partyRoles.length>0&&(e=t.partyRoles),t.govtRoles.length>0&&(e=t.govtRoles),e.length<1?20:h(e,"rank")[0].rank},_=function(t,e){var n=document.createElement("div");if(n.classList.add("cell-group-container"),"party"===e){var r=[];t.forEach(function(t,e){var n=r.find(function(e){return e.name===t.party.abbreviation});if(n)n.msps.push({mspID:e,msp:t,ranking:w(t)});else{r.push({name:t.party.abbreviation,msps:[]});r[r.length-1].msps.push({mspID:e,msp:t,ranking:w(t)})}}),r.sort(function(t,e){return e.msps.length>t.msps.length}),r.forEach(function(t){for(var e=[],r=0;r<15;r++)!function(n){var r=[];t.msps.forEach(function(t){t.ranking===n&&r.push(t)}),r.length>0&&(r=y(r,"msp","lastName"),e=e.concat(r),console.log(e))}(r);var o=document.createElement("div");o.classList.add("cell-group");var i="";e.forEach(function(t){i+=g(t.msp,t.mspID)}),o.innerHTML=i,n.appendChild(o)}),console.log(r)}return n},T=function(){var t=document.getElementsByClassName("nav--menu-wrapper")[0],e=document.getElementsByClassName("nav--burger")[0],n=document.getElementsByClassName("nav--menu")[0],r=window.matchMedia("(min-width: 640px)"),o=function(e){return function(){n.classList.remove("nav--menu__open"),n.classList.remove("nav--menu__was-opened"),t.classList.toggle("nav--menu-wrapper",e.matches),t.classList.toggle("nav--menu-mobile-wrapper",!e.matches)}};e.addEventListener("click",function(){return function(){n.classList.toggle("nav--menu__open"),n.classList.contains("nav--menu__was-opened")||n.classList.add("nav--menu__was-opened")}}()),r.addListener(o(r)),window.onload=o(r)},P=function(){u.appendChild(c('\n\t<div class="modal">\n\t\t<div class="modal--box">\n\t\t\t<div class="modal--close">&times;</div>\n\t\t\t<div class ="modal--box-content"><div>\n\t\t</div>\n\t</div>\n\t'));var t=document.getElementsByClassName("modal")[0];document.getElementsByClassName("modal--close")[0].addEventListener("click",function(t){return function(){t.classList.toggle("modal__hidden")}}(t)),t.classList.toggle("modal__hidden")},E=function(t){var e='\n\t<div class=pref-bar>\n\t\t<form id="pref-form" onsubmit="return false">\n\t\t\t<div>\n\t\t\t\t<label for="date-input">Date:</label>\n\t\t\t\t<input type="date" id="date-input" value="'+i.dateToStr(t)+'" name="date-input" max="'+i.dateToStr(t)+'" min="1999-05-12" required>\n\t\t\t\t<span class="validity"></span>\n\t\t\t</div>\n\n\t\t\t<label for="group-by">Group by:</label>\n\t\t\t<select id="group-by" name="group-by" value="party">\n\t\t\t\t<option value="party">Party</option>\n\t\t\t</select>\n\n\t\t</form>\n\t</div>\n\t';u.appendChild(c(e));var n=document.getElementById("pref-form"),r=document.getElementById("date-input"),o=document.getElementById("group-by");n.addEventListener("change",function(t){a.refreshView(i.strToDate(r.value),o.value)})};e.init=function(t){T(),E(t),P()},e.refreshCells=function(t,e,n){var r=document.getElementsByClassName("cell-group-container")[0];r&&u.removeChild(r);var o=_(t,n);u.appendChild(o);for(var i=document.getElementsByClassName("cell"),s=0;s<i.length;s++)i[s].addEventListener("click",b(Number(i[s].id),e))}}]);